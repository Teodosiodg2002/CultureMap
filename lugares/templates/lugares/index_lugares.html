{% extends 'lugares/base.html' %} {% block title %}Lugares Aprobados -
CultureMap{% endblock %} {% block content %}

<div id="map" class="mb-4 shadow-sm" style="border-radius: 8px"></div>

<h1 class="mb-4">Lugares de interés aprobados</h1>

<div class="row">
  {% for lugar in lugares %}
  <div class="col-md-6 col-lg-4 mb-4">
    <div class="card h-100">
      <div class="card-body d-flex flex-column">
        <h5 class="card-title">{{ lugar.nombre }}</h5>
        <h6 class="card-subtitle mb-2 text-muted">
          {{ lugar.get_categoria_display }}
        </h6>
        <p class="card-text">{{ lugar.descripcion|truncatewords:20 }}</p>
        <a
          href="{% url 'detalle_lugar' lugar.pk %}"
          class="btn btn-primary mt-auto"
          >Ver detalles</a
        >
      </div>
    </div>
  </div>
  {% empty %}
  <div class="col">
    <div class="alert alert-info" role="alert">
      No hay lugares aprobados todavía.
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %} 
{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function () {

        var map = L.map('map').setView([37.1773, -3.5986], 14); 

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);


        {% for lugar in lugares_para_mapa %}
            var marker = L.marker([{{ lugar.lat }}, {{ lugar.lng }}]).addTo(map);

            var popupContent = `<b><a href="{% url 'detalle_lugar' lugar.pk %}">{{ lugar.nombre }}</a></b><br>{{ lugar.get_categoria_display }}`;

            marker.bindPopup(popupContent);
        {% endfor %}
    
    });
</script>
{% endblock %}
